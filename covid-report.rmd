---
title: <center>COVID-19 Report</center>
author: <center>SAI Law & Economics</center>
date: <center>`r Sys.setlocale('LC_TIME','English'); format(Sys.time(),'%B %d, %Y')`</center>
output:
   html_document:
      toc: true
      toc_depth: 2
      toc_float:
         collapse: false
         smooth_scroll: true
---

```{r setup, include=FALSE}

##### R Markdown global options #####

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, include = TRUE, fig.align = 'center', out.width = '100%')

##### libraries #####

library(tidyverse)
library(plotly)
library(extrafont)
library(mgcv)
loadfonts(device = 'win') # The first time you install this package, you have to execute font_import()

##### data import #####

mobility_raw_data <- read_csv('inputs/global_mobility_report.csv')

covid_data <- read_csv('inputs/owid-covid-data.csv')

##### Colors #####

colors_pal <- c('#004170','#098d9c','#cc003a','#b2d600','#ffcc00','#00c954','#00bf9f','#00a9bf','#6f00bf','#b02c88')

colors_continent <- sample(colors_pal,6,replace = FALSE)

##### Dummy function #####

do_nothing <- function(df) { return(df) }

```

<br>

Sources:

* Our World in Data. Data collected, aggregated, and documented by Diana Beltekian, Daniel Gavrilov, Charlie Giattino, Joe Hasell, Bobbie Macdonald, Edouard Mathieu, Esteban Ortiz-Ospina, Hannah Ritchie, Max Roser. https://github.com/owid/covid-19-data/tree/master/public/data. Accessed: `r Sys.setlocale('LC_TIME','English'); format(Sys.time(), '%B %d, %Y')`.

* Google LLC "Google COVID-19 Community Mobility Reports". https://www.google.com/covid19/mobility/ Accessed: `r Sys.setlocale('LC_TIME','English'); format(Sys.time(), '%B %d, %Y')`.

# Intro

[Text]

# COVID-19 

```{r data_frame}

covid1 <- covid_data %>%
   arrange(location,date) %>% 
   group_by(location) %>%
   mutate(max_cases = max(total_cases,na.rm = TRUE),
          max_deaths = max(total_deaths,na.rm = TRUE),
          max_cases_per_million = max(total_cases_per_million,na.rm = TRUE),
          max_deaths_per_million = max(total_deaths_per_million,na.rm = TRUE)) %>%
   filter(location != 'World') %>% 
   do_nothing()

```

[Text]

## Total cases

[Text]

```{r total_cases_by_country_plot, fig.height=8}

covid1 %>% 
   filter( (max_cases_per_million > 1000 &
               max_cases > 40000 &
               population > 5000000 &
               total_cases >= 100) |
              location == 'China' ) %>%
   ggplot(aes(x = date, y = total_cases/1000, color = continent)) +
   geom_line(size = 2) +
   facet_wrap(~fct_reorder(location,max_cases, .desc = TRUE), scales = 'free_y') +
   scale_y_continuous(labels = scales::comma_format(accuracy = 1)) +
   scale_color_manual(values = colors_continent) +
   theme_minimal() +
   theme(panel.grid = element_blank(),
         panel.background = element_rect(fill = '#fafafa', color = 'white'),
         strip.background = element_rect(fill = '#fafafa', color = 'white'),
         strip.text = element_text(family = 'Century Gothic', color = '#002126'),
         legend.position = 'bottom',
         legend.title = element_blank(),
         axis.title.x = element_blank(),
         axis.text = element_text(family = 'Century Gothic', color = '#002126'),
         text = element_text(family = 'Century Gothic', color = '#002126'),
         plot.title = element_text(hjust = 0.5, face = 'bold'),
         plot.caption = element_text(hjust = 0),
         NULL) +
   ylab('Total cases (\'000)\n') +
   labs(title = 'Total cases\' evolution since the 100th case, by country\n',
        caption = '* Only countries with more than 40,000 cases, more than 1,000 cases per million habitants,\nand with a total population greater than 5 million people are shown (except for China).\n\nData source: Our World in Data.')

```


## Subsection

[Text]

# Global Mobility

[Text]

## Subsection 1

[Text]

### Sub^2section 1


